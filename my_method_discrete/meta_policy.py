
import torch
import numpy

def KL(a, b, state_visitation):
    a=torch.clip(a,0.0001,1.0)
    b=torch.clip(b,0.0001,1.0)
    cc=torch.sum(a * torch.log(a) - a * torch.log(b) ,dim=1).reshape((16,1))
    return torch.sum(state_visitation*cc) 

# d=2
'''
training_meta_theta=torch.tensor([[-1.3453e+00,  8.4050e-01,  1.8522e+00, -1.3474e+00],
        [-1.2883e+00,  2.5834e+00, -4.1027e-01, -8.8482e-01],
        [-3.8953e-01,  1.7065e+00, -9.8510e-01, -3.3190e-01],
        [-2.3574e-02,  1.6721e-01, -7.3353e-02, -7.0283e-02],
        [-7.2375e-01, -9.0497e-01,  2.6835e+00, -1.0547e+00],
        [-1.2105e+00, -8.5522e-01,  3.2741e+00, -1.2084e+00],
        [-1.4597e+00,  1.4396e+00,  1.5939e+00, -1.5737e+00],
        [-7.2481e-01,  2.3825e+00, -7.2065e-01, -9.3709e-01],
        [-1.9936e-01,  1.6557e-01,  1.0272e-01, -6.8928e-02],
        [-5.6761e-01, -7.8136e-02,  1.1161e+00, -4.7039e-01],
        [-1.3467e+00,  2.7498e+00, -1.0227e-01, -1.3007e+00],
        [-1.1379e+00,  3.1249e+00, -8.2362e-01, -1.1634e+00],
        [-1.1827e-01, -1.1756e-01,  3.6775e-01, -1.3191e-01],
        [-4.6190e-01, -2.5093e-01,  1.2050e+00, -4.9215e-01],
        [-1.1204e+00, -7.6465e-01,  2.9529e+00, -1.0678e+00],
        [ 3.1300e-07,  2.1723e-05, -2.4879e-05,  1.3542e-07]],
       requires_grad=False)


training_meta_theta_no_hole=torch.tensor([[-2.6676,  2.5738, -0.2887, -2.6750],
        [-1.9896,  2.7592, -1.1140, -2.1067],
        [-1.6433,  2.0680, -1.2569, -1.8562],
        [-1.4591,  1.5675, -1.6353, -1.6191],
        [-2.7840, -1.8724,  3.6894, -2.5779],
        [-2.5824, -0.3216,  3.7105, -2.5521],
        [-2.5513,  0.8343,  3.8499, -2.5250],
        [-2.8509,  2.8984, -3.2379, -2.7482],
        [-2.2198, -1.9536,  2.2616, -1.9592],
        [-2.0926,  0.9336,  2.3797, -2.1446],
        [-2.1235,  0.8650,  2.8642, -2.1439],
        [-2.7618,  2.8367, -3.1221, -2.7379],
        [-1.5794, -1.5709,  1.5708, -1.5178],
        [-1.9727, -2.3238,  2.0810, -2.0525],
        [-2.1341, -2.4092,  2.2148, -2.1739],
        [ 0.0000,  0.0000,  0.0000,  0.0000]], requires_grad=False)
'''
# d=1

training_meta_theta=torch.tensor([[-1.3453e+00,  8.4050e-01,  1.8522e+00, -1.3474e+00],
        [-1.2883e+00,  2.5834e+00, -4.1027e-01, -8.8482e-01],
        [-3.8953e-01,  1.7065e+00, -9.8510e-01, -3.3190e-01],
        [-2.3574e-02,  1.6721e-01, -7.3353e-02, -7.0283e-02],
        [-7.2375e-01, -9.0497e-01,  2.6835e+00, -1.0547e+00],
        [-1.2105e+00, -8.5522e-01,  3.2741e+00, -1.2084e+00],
        [-1.4597e+00,  1.4396e+00,  1.5939e+00, -1.5737e+00],
        [-7.2481e-01,  2.3825e+00, -7.2065e-01, -9.3709e-01],
        [-1.9936e-01,  1.6557e-01,  1.0272e-01, -6.8928e-02],
        [-5.6761e-01, -7.8136e-02,  1.1161e+00, -4.7039e-01],
        [-1.3467e+00,  2.7498e+00, -1.0227e-01, -1.3007e+00],
        [-1.1379e+00,  3.1249e+00, -8.2362e-01, -1.1634e+00],
        [-1.1827e-01, -1.1756e-01,  3.6775e-01, -1.3191e-01],
        [-4.6190e-01, -2.5093e-01,  1.2050e+00, -4.9215e-01],
        [-1.1204e+00, -7.6465e-01,  2.9529e+00, -1.0678e+00],
        [ 3.1300e-07,  2.1723e-05, -2.4879e-05,  1.3542e-07]],
       requires_grad=False)


training_meta_theta_no_hole=torch.tensor([[-1.4673,  3.9165, -0.5690, -1.4802],
        [-0.9265,  2.5568, -0.4728, -0.7575],
        [-0.3952,  1.2107, -0.1246, -0.2908],
        [-0.1646,  0.7533, -0.0952, -0.0935],
        [-1.2426, -1.2215,  4.4355, -1.5714],
        [-1.7582, -0.1459,  4.1430, -1.8389],
        [-1.6809,  3.6929,  0.3733, -1.9853],
        [-0.7819,  2.7273, -0.5735, -0.9720],
        [-0.2832, -0.3470,  1.4724, -0.4423],
        [-1.0894, -0.1287,  2.5504, -0.9323],
        [-1.8981,  0.4099,  3.7129, -1.8246],
        [-1.4086,  4.2753, -1.0125, -1.4543],
        [-0.1089, -0.1076,  0.7134, -0.0969],
        [-0.6198, -0.2817,  1.7646, -0.4631],
        [-1.0231, -0.6567,  3.0189, -0.9391],
        [ 0.1000,  0.1000,  0.1000,  0.1000]], requires_grad=False)